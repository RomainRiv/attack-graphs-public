# Attack Graph PoC
[üëâ Click Here to access the graph üëà](graph.html)

## What is this tool? 
### Aim of the tool
This is a proof of concept for an web-based, interactive attack graph editor. It is currently in a really early stage.  

I wrote this tool with two objectives in mind:
- Learn modern web development
- Experiment with Attack Graph modeling

This tool implements an experimental Attack Graph Methodology which relies on Attacker States (AS) as Nodes and Elementary Attacks (EA) as edges.

### How is it built? 
This tool is built using [React](https://react.dev/), [Vite](https://vite.dev/) and [ReactFlow](https://reactflow.dev/) (among other dependencies).

## Features
### Available
- Basic Graph Editing
  - Add/remove Nodes
  - Add/Remove Edges
  - Rename Elements
- Import and Export in JSON
- Automatic Graph Layout (experimental)

### To-Do
- Implement graph exploration in frontend (find "shortest" paths between two nodes)
- Add capability to assign attack feasibility to an edge
- Add capability to assign impact to a node
- Add automatic risk computation for a node
- Integrate LLM based generation of edge in the Web UI (using OpenAI-like API, ollama-like API)

## Interfacing wiht LLMs
### Concept
LLMs (such as GPT4x, Gemini, Claude, llama just to name a few...) can greatly accelerate the Cybersecurity Analysis of complex systems. 

### Converting an assessment into an Attack Graph
Once you've provided sufficient context to the LLMs and optionally clarified some open points, you can request the LLM to start to generate what would become the attack graph. Depending on the model (especially its typical answer length limit), you might want to request the LLM to first generate the Attacker States, and then to generate the Elementary Attacks in another answer.

Here is the methodology that you can copy/past (and adapt!) in your prompt.

```markdown
üß≠ Methodology Summary: Graph-Based Modeling of Cybersecurity Attacks

‚úÖ Objective

This methodology provides a graph-based approach to modeling cybersecurity attack progression in complex systems. It supports:
	‚Ä¢	Systematic risk assessment
	‚Ä¢	Early threat modeling in system design
	‚Ä¢	Understanding attacker capabilities and escalation paths
	‚Ä¢	Evaluating and comparing attack feasibility
	‚Ä¢	Supporting mitigation selection and design decisions

It is applicable to domains such as IoT, embedded systems, industrial control systems, and IT infrastructure.

‚∏ª

üß† Key Concepts

1. Attacker States (AS) ‚Äì Graph Nodes

Each Attacker State represents a capability or level of access the attacker has at a point in the system.
	‚Ä¢	NOT actions or exploits
	‚Ä¢	Represent a stable privilege level, position, or access scope
	‚Ä¢	Can be thought of as:
‚ÄúThe attacker is able to‚Ä¶‚Äù

üü¶ Examples:
	‚Ä¢	Attacker is able to access the physical enclosure of a device
	‚Ä¢	Attacker is able to read/write files on a remote system
	‚Ä¢	Attacker is able to execute arbitrary code in a trusted process
	‚Ä¢	Attacker is able to manipulate network traffic within a subnet

‚∏ª

2. Elementary Attacks (EA) ‚Äì Graph Edges

Each Elementary Attack is an action or exploit that enables the attacker to transition from one state (AS) to another.
	‚Ä¢	Describes how the attacker escalates their capabilities
	‚Ä¢	Can be technical (e.g. exploiting a buffer overflow), physical (e.g. device tampering), or social (e.g. phishing)

Each edge in the graph connects:
	‚Ä¢	A source Attacker State (before the attack)
	‚Ä¢	A target Attacker State (after successful execution)

‚∏ª

3. Attack Feasibility Scoring

Each Elementary Attack is assigned a feasibility score to represent how difficult it is to execute.

For each Elementary Attack, propose a feasibility that can be "Very Low", "Low", "Medium" or "High".

‚∏ª

üåê What the Graph Represents
	‚Ä¢	A set of attacker capabilities (AS) as nodes
	‚Ä¢	A set of attacks or transitions (EA) as edges
	‚Ä¢	Feasibility scores attached to each attack

Together, this forms a directed attack graph representing all known or hypothesized ways an attacker could move through a system to gain deeper control.

‚∏ª

üîß Benefits of the Approach

‚úÖ Makes attacker progression explicit and traceable
‚úÖ Enables early-stage threat modeling even before all attacks are known
‚úÖ Scales well ‚Äî new attacks can be added without disrupting the structure
‚úÖ Aligns with risk-based security design principles
‚úÖ Compatible with various frameworks (e.g., MITRE ATT&CK, STRIDE, TARA)

```

### Generating the Attack Graph to JSON format
Once you're happy with the graph generated by the LLM, you can request an export in JSON, so that you can open the graph in the [graph editor](graph.html). To do so, write this message that describes the JSON schema of a graph that can be loaded onto the editor

```markdown
now generate a json of the attack graph according to this json schema

{"$defs": {"Data": {"properties": {"label": {"description": "Short description of the attacker state (e.g., 'attacker can access device memory').", "title": "Label", "type": "string"}, "inputs": {"description": "Number of incoming edges (attacks leading to this state).", "title": "Inputs", "type": "integer"}, "outputs": {"description": "Number of outgoing edges (attacks originating from this state).", "title": "Outputs", "type": "integer"}}, "required": ["label", "inputs", "outputs"], "title": "Data", "type": "object"}, "Edge": {"properties": {"id": {"description": "Unique identifier for the elementary attack, a the short name of the EA", "title": "Id", "type": "string"}, "source": {"description": "ID of the source attacker state \u2014 where the attacker starts before this exploit.", "title": "Source", "type": "string"}, "target": {"description": "ID of the target attacker state \u2014 the new capability after executing the attack.", "title": "Target", "type": "string"}, "label": {"description": "Short description of the elementary attack.", "title": "Label", "type": "string"}}, "required": ["id", "source", "target", "label"], "title": "Edge", "type": "object"}, "Node": {"properties": {"id": {"description": "Unique identifier for the attacker state (AS).", "title": "Id", "type": "string"}, "type": {"description": "UI component type; typically 'resizable-node' for attacker state nodes.", "title": "Type", "type": "string"}, "data": {"$ref": "#/$defs/Data", "description": "Metadata about the attacker state, including label and connection info."}}, "required": ["id", "type", "data"], "title": "Node", "type": "object"}}, "properties": {"nodes": {"description": "List of all attacker states (AS) in the attack graph.", "items": {"$ref": "#/$defs/Node"}, "title": "Nodes", "type": "array"}, "edges": {"description": "List of all elementary attacks (EA) describing transitions between attacker states.", "items": {"$ref": "#/$defs/Edge"}, "title": "Edges", "type": "array"}}, "required": ["nodes", "edges"], "title": "GraphModel", "type": "object"}
```

The LLM should answer with a valid json that you can copy and paste into a JSON file. You can then import the JSON graph into the graph editor (it might or might not work, as LLMs are not exactly great at respecting json schemas üôÉ).

## Disclaimer

This tool is provided solely for demonstration and proof-of-concept purposes. It is not intended for commercial use, nor is it guaranteed to be accurate, complete, or free from errors. The authors and contributors of this tool assume no responsibility or liability for any damages resulting from its use, and no warranties‚Äîexpress or implied‚Äîare provided. By using this tool, you agree to assume all risk and to comply with all applicable laws and regulations. If you choose to rely on any information provided by this tool, you do so entirely at your own risk.

## Licenses
Licenses are available [here](licenses.json)